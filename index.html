<!DOCTYPE html>
<html lang="english">
<meta charset='UTF-8'>

<head>
    <title>Toronto Waste Lookup</title>
    <link rel='stylesheet' href='css/style.css'>
    <link rel='stylesheet' href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

</head>

</html>

<body>
<div id='banner'>Toronto Waste Lookup</div>

<div id='searchBox'>
    <input type='text' id='searchBar' name='searchBar'>
    <div id='searchIcon'>
        <button  type='button' id='search'> <i class="fa fa-search fa-flip-horizontal" aria-hidden="true" style='width: 1em'></i></button>
        <script>
        //Create event listener clicking search icon, NB listener needs brackets off or else it runs on pageload
        document.getElementById('search').addEventListener('click', loadGarbage);
        //create event listener for keydown, call loadGarbage if enterkey is pressed in searchBar
        document.getElementById('searchBar').addEventListener('keydown', function checkKeyPress(x){
            if (x.which === 13){ //not sure if it also needs to check x.keycode?
                loadGarbage();
            }    
        });
        
        function loadGarbage(){
            let searchText = searchBar.value;
            console.log(searchText);
            //Create XHR
            var xhr = new XMLHttpRequest();
            xhr.open('GET', 'https://secure.toronto.ca/cc_sr_v1/data/swm_waste_wizard_APR?limit=1000', true);
            xhr.onload = function(){
                json = JSON.parse(xhr.responseText);
                var garbList = '';
                /*TODO: search through json[i].keywords for searchText,
                for each entry that matches, append garbList with a 2-column div containing json[i].title : json[i].body,
                create a css class of div that will contain these columns*/
                
                
                
            }
            xhr.onerror = function(){
                console.log('XHR request error')
            }
            xhr.send();
        }

        </script>
        <div id="garbo"></div>
    </div>
</div>





</body>